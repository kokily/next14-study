# Partial Prerendering (Optional)

> 부분 사전 렌더링은 Next.js 14에 도입된 실험적 기능입니다. 기능이 안정화되면 이 페이지의 내용이 업데이트될 수 있습니다. 실험적인 기능을 사용하지 않으려면 이 장을 건너뛰어도 됩니다. 이 장은 과정을 완료하는 데 필요하지 않습니다.

이 챕터에서 다룰 주제는 다음과 같습니다.

- 부분 사전 렌더링이란 무엇입니까?
- 부분 사전 렌더링의 작동 방식.

## **[정적 콘텐츠와 동적 콘텐츠 결합](https://nextjs.org/learn/dashboard-app/partial-prerendering#combining-static-and-dynamic-content)**

현재 경로 내에서 [동적 함수](https://nextjs.org/docs/app/building-your-application/routing/route-handlers#dynamic-functions)(예: `noStore()`, `cookies()` 등)를 호출하면 전체 경로가 동적이 됩니다.

이는 오늘날 대부분의 웹 앱이 구축되는 방식과 일치합니다. **전체 애플리케이션** 또는 **특정 경로**에 대해 정적 렌더링과 동적 렌더링 중에서 선택합니다.

그러나 대부분의 경로는 완전히 정적이거나 동적이지 않습니다. 정적 콘텐츠와 동적 콘텐츠가 모두 포함된 경로가 있을 수 있습니다. 예를 들어 소셜 미디어 피드가 있고 게시물은 정적이지만 게시물에 대한 좋아요 수는 동적이라고 가정해 보겠습니다. 또는 제품 세부 정보는 정적이지만 사용자 장바구니는 동적인 전자 상거래 사이트입니다.

대시보드 페이지로 돌아가서 정적 컴포넌트와 동적 컴포넌트 중 어떤 컴포넌트를 고려하시겠습니까?

준비가 되면 아래 버튼을 클릭하여 대시보드 경로를 분할하는 방법을 확인하세요:

![image01](https://nextjs.org/_next/image?url=%2Flearn%2Fdark%2Fdashboard-static-dynamic-components.png&w=3840&q=75&dpl=dpl_7qDwkTDwmgWzVYKGukeHHPrgxfLF)

- `<SideNav>` 컴포넌트는 데이터에 의존하지 않으며 사용자에게 맞춤설정되지 않으므로 **정적**일 수 있습니다.
- `<페이지>`의 컴포넌트는 자주 변경되는 데이터에 의존하고 사용자에게 맞춤설정되므로 **동적**이 가능합니다.

## **[부분 사전 렌더링이란??](https://nextjs.org/learn/dashboard-app/partial-prerendering#what-is-partial-prerendering)**

Next.js 14에는 **부분 사전 렌더링**이라는 새로운 렌더링 모델의 미리보기가 있습니다. 부분 사전 렌더링은 일부 부분을 동적으로 유지하면서 정적 로딩 셸을 사용하여 경로를 렌더링할 수 있는 실험적 기능입니다. 즉, 경로의 동적 부분을 분리할 수 있습니다. 예를 들어:

![image02](https://nextjs.org/_next/image?url=%2Flearn%2Fdark%2Fthinking-in-ppr.png&w=3840&q=75&dpl=dpl_7qDwkTDwmgWzVYKGukeHHPrgxfLF)

사용자가 경로를 방문할 때:

- 정적 경로 *셸*이 제공되므로 초기 로드 속도가 빨라집니다.
- 셸에는 동적 콘텐츠가 비동기로 로드되는 *구멍*이 남습니다.
- 비동기 홀이 병렬로 로드되어 페이지의 전체 로드 시간이 단축됩니다.

이는 전체 경로가 완전히 정적이거나 동적인 오늘날 애플리케이션의 작동 방식과 다릅니다.

부분 사전 렌더링은 매우 빠른 정적 에지 전달과 완전한 동적 기능을 결합하며, 최고의 정적 사이트 생성과 동적 전달을 결합하여 [웹 애플리케이션의 기본 렌더링 모델이 될](https://vercel.com/blog/partial-prerendering-with-next-js-creating-a-new-default-rendering-model) 가능성이 있다고 믿습니다.

### 퀴즈를 풀 시간입니다!
지식을 테스트하고 방금 배운 내용을 확인하세요.
부분 사전 렌더링의 맥락에서 구멍은 무엇입니까?

- JavaScript가 비활성화된 위치
- 동적 콘텐츠가 비동기적으로 로드되는 위치
- 타사 스크립트가 로드되는 위치

## **[부분 사전 렌더링의 작동 방식?](https://nextjs.org/learn/dashboard-app/partial-prerendering#how-does-partial-prerendering-work)**

부분 사전 렌더링은 React의 [동시 API](https://react.dev/blog/2021/12/17/react-conf-2021-recap#react-18-and-concurrent-features)를 활용하고 [Suspense](https://reactjs.org/docs/concurrent-mode-suspense.html)를 사용하여 일부 조건이 충족될 때까지(예: 데이터 로드) 애플리케이션의 렌더링 부분을 연기합니다.

대체는 다른 정적 콘텐츠와 함께 초기 정적 파일에 포함됩니다. 빌드 시(또는 재검증 중에) 경로의 정적 부분은 *사전 렌더링*되고 나머지 부분은 사용자가 경로를 요청할 때까지 *연기*됩니다.

Suspense에서 컴포넌트를 래핑해도 컴포넌트 자체가 동적으로 만들어지지는 않지만(이 동작을 달성하기 위해 `unstable_noStore`를 사용했다는 점을 기억하세요) 오히려 Suspense가 경로의 정적 부분과 동적 부분 사이의 경계로 사용된다는 점에 주목할 가치가 있습니다.

부분 사전 렌더링의 가장 큰 장점은 이를 사용하기 위해 코드를 변경할 필요가 없다는 것입니다. Suspense를 사용하여 경로의 동적 부분을 래핑하는 한 Next.js는 경로의 어느 부분이 정적이고 어느 부분이 동적인지 알 수 있습니다.

> 노트: 부분 사전 렌더링을 구성하는 방법에 대해 자세히 알아보려면 부분 사전 렌더링(실험) 문서를 참조하거나 부분 사전 렌더링 템플릿 및 데모를 사용해 보세요. 이 기능은 실험적이며 아직 프로덕션 배포용으로 준비되지 않았다는 점에 유의하는 것이 중요합니다.

## **[요약](https://nextjs.org/learn/dashboard-app/partial-prerendering#summary)**

애플리케이션에서 데이터 가져오기를 최적화하기 위해 몇 가지 작업을 수행했습니다. 요약하자면:

1. 서버와 데이터베이스 간의 대기 시간을 줄이기 위해 애플리케이션 코드와 동일한 지역에 데이터베이스를 만들었습니다.
2. 리액트 서버 컴포넌트를 사용하여 서버에서 데이터를 가져왔습니다. 이를 통해 서버에서 비용이 많이 드는 데이터 가져오기 및 논리를 유지하고, 클라이언트 측 JavaScript 번들을 줄이고, 데이터베이스 비밀이 클라이언트에 노출되는 것을 방지할 수 있습니다.
3. SQL을 사용하여 필요한 데이터만 가져오므로 각 요청에 대해 전송되는 데이터의 양과 메모리 내 데이터를 변환하는 데 필요한 JavaScript의 양이 줄어듭니다.
4. JavaScript를 사용하여 데이터 가져오기를 병렬화하는 것이 합리적입니다.
5. 느린 데이터 요청이 전체 페이지를 차단하는 것을 방지하고 사용자가 모든 것이 로드될 때까지 기다리지 않고 UI와 상호 작용을 시작할 수 있도록 스트리밍을 구현했습니다.
6. 데이터 가져오기를 필요한 컴포넌트로 이동하여 부분 사전 렌더링을 준비할 때 경로의 어느 부분이 동적으로 이루어져야 하는지 분리합니다.

다음 장에서는 데이터를 가져올 때 구현해야 할 두 가지 일반적인 패턴인 검색과 페이지 매김을 살펴보겠습니다.